Quero implementar/ajustar mensagens autom√°ticas flutuantes (uma √∫nica vez) para (1) pagamento confirmado e (2) doa√ß√£o confirmada, mantendo o app web exatamente como est√°, sem quebrar nada, sem pesar e sem mexer na integra√ß√£o existente de pagamentos/doa√ß√µes (Asaas ou qualquer outra). Fa√ßa tudo de forma organizada, aditiva e com mudan√ßas m√≠nimas.

CONTEXTO
- App web: React + Vite (frontend) + Express + TypeScript (backend)
- Pagamentos e doa√ß√µes j√° funcionam hoje
- Quero apenas reagir aos eventos ‚Äúpagamento confirmado‚Äù e ‚Äúdoa√ß√£o confirmada‚Äù
- Mensagens aparecem UMA vez por usu√°rio por evento, flutuantes, com bot√£o ‚ÄúFechar‚Äù
- Personagem: usar a mesma imagem fornecida (n√£o criar novos assets agora)

REGRAS OBRIGAT√ìRIAS
1) N√ÉO refatorar nem alterar l√≥gica do Asaas/pagamentos/doa√ß√µes. Apenas ler dados j√° existentes e/ou ouvir os eventos j√° existentes.
2) N√ÉO mudar rotas/fluxo do app. Apenas adicionar componentes e endpoints isolados.
3) Implementa√ß√£o leve: sem libs pesadas, sem anima√ß√µes exageradas, sem loops de polling. Use chamadas simples quando o usu√°rio entrar no app/painel.
4) Garantir que npm run dev e npm run build continuam funcionando.
5) Seguran√ßa: nunca exibir dados sens√≠veis; mensagens s√£o gen√©ricas.

OBJETIVO 1 ‚Äî MENSAGEM P√ìS-PAGAMENTO (ASSINATURA)
- Exibir automaticamente UMA √öNICA VEZ ap√≥s confirma√ß√£o de pagamento/assinatura para o usu√°rio.
T√≠tulo:
"Bem-vindo ao plant√£o! üëã"
Texto:
"Obrigado por confiar no Salva Plant√£o.
Agora voc√™ tem mais agilidade, mais seguran√ßa
e menos dor de cabe√ßa no plant√£o.
Bora trabalhar juntos. üí™ü©∫"

OBJETIVO 2 ‚Äî MENSAGEM P√ìS-DOA√á√ÉO (CAUSA SOCIAL)
IMPORTANTE: Doa√ß√£o √© para CAUSAS SOCIAIS. 100% do valor arrecadado, descontados apenas custos operacionais e impostos, ser√° doado.
- Exibir automaticamente UMA √öNICA VEZ ap√≥s confirma√ß√£o da doa√ß√£o para o usu√°rio.
- A mensagem deve incluir o NOME DA CAUSA SOCIAL selecionada pelo administrador no momento da doa√ß√£o (ex: "Apoio a Crian√ßas com C√¢ncer").
T√≠tulo:
"Obrigado por apoiar uma causa üíö"
Texto:
"Sua doa√ß√£o ser√° destinada integralmente a uma causa social,
descontados apenas os custos operacionais e impostos.

Hoje, voc√™ ajudou a apoiar:
{{NOME_DA_CAUSA}}

Gestos assim mudam vidas. Obrigado por fazer parte disso."

BACKEND ‚Äî DADOS E CONTROLE (LEVE E SEM BUG)
1) Criar uma tabela simples para controlar exibi√ß√£o (ou campos equivalentes se j√° existir algo parecido):
Tabela: user_one_time_messages
Campos:
- userId (pk/fk)
- paymentWelcomeShown (boolean default false)
- donationThanksShown (boolean default false)
- updatedAt

2) Garantir que a DOA√á√ÉO tenha causa social associada:
- Identificar onde a doa√ß√£o √© registrada hoje.
- Sem mexer no fluxo do Asaas: apenas GARANTIR que ao registrar a doa√ß√£o localmente, exista um campo:
  - socialCauseName (string) ou socialCauseId -> resolvido para nome
- Se j√° existir ‚Äúcausa social‚Äù em algum lugar, reutilizar (n√£o duplicar).
- Se n√£o existir, criar a coluna/tabela m√≠nima para armazenar o nome da causa escolhida pelo admin no momento da doa√ß√£o.

3) Endpoints (Express):
- GET /api/one-time-messages
  Retorna ao usu√°rio logado quais mensagens devem aparecer.
  Exemplo:
  {
    payment: { shouldShow: true/false },
    donation: { shouldShow: true/false, socialCauseName?: "..." }
  }
  Regras:
  - payment.shouldShow = true se houver pagamento confirmado e paymentWelcomeShown = false
  - donation.shouldShow = true se houver doa√ß√£o confirmada e donationThanksShown = false
  - donation.socialCauseName deve vir da √∫ltima doa√ß√£o confirmada do usu√°rio (ou da doa√ß√£o mais recente sem ‚Äúack‚Äù)

- POST /api/one-time-messages/ack
  Payload: { type: "payment" | "donation" }
  Marca como exibida/fechada (true) a mensagem correspondente.

4) N√£o usar polling:
- O frontend chama GET /api/one-time-messages apenas:
  - ao entrar no app (ex: dashboard) e
  - opcionalmente ap√≥s retornar de uma p√°gina de ‚Äúsucesso‚Äù (se existir).

FRONTEND ‚Äî UI FLOUTANTE (LEVE, BONITA, SEM PESO)
5) Criar um componente √∫nico e reutiliz√°vel:
- OneTimeMessageOverlay (ou nome similar)
Caracter√≠sticas:
- flutuante (modal leve ou toast expandido)
- bot√£o ‚ÄúFechar‚Äù
- anima√ß√£o m√≠nima (fade/slide curto, opcional)
- n√£o travar a navega√ß√£o (n√£o bloquear)
- aparece s√≥ quando backend indicar

6) Personagem:
- Exibir a imagem do personagem ao lado do texto
- Para pagamento: estilo mais ‚Äúconfiante/energ√©tico‚Äù (leve)
- Para doa√ß√£o social: estilo mais ‚Äúsereno e respeitoso‚Äù
  (apenas via CSS: reduzir brilho/anima√ß√£o, rota√ß√£o/escala muito leve)

7) Integra√ß√£o:
- No boot do app (ou dashboard), chamar GET /api/one-time-messages
- Se payment.shouldShow: renderizar overlay de pagamento
- Se donation.shouldShow: renderizar overlay de doa√ß√£o com socialCauseName em destaque
- Ao clicar ‚ÄúFechar‚Äù: chamar POST /api/one-time-messages/ack e esconder

QUALIDADE / ANTI-BUG
8) Evitar re-render infinito:
- use react-query se j√° existe no projeto, ou use um fetch simples com state e guard.
- garantir que a chamada acontece 1 vez por carregamento de p√°gina.
9) Tratar casos:
- Se n√£o houver socialCauseName, mostrar "Causa social" (fallback) sem quebrar.
- Se permiss√£o de notifica√ß√£o n√£o existir (irrelevante), isso n√£o afeta ‚Äî aqui √© apenas overlay interno.

ENTREGA OBRIGAT√ìRIA
- Listar exatamente arquivos criados/alterados
- Listar migrations/tabelas adicionadas
- Explicar em poucas linhas onde voc√™ leu ‚Äúpagamento confirmado‚Äù e ‚Äúdoa√ß√£o confirmada‚Äù sem mexer no Asaas
- Confirmar que a vers√£o web continua funcionando igual e que a feature √© leve

Fa√ßa as mudan√ßas com cuidado e valide localmente o fluxo completo.
